<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ShowScout</title>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> <!-- Using Axios for HTTP requests -->
</head>

<body>
	<main>
		<h1>Find Live Entertainment</h1>
		<form id="searchForm">
			<div>
				<label>Category:</label>
				<input type="radio" name="category" value="Sport"> Sport
				<input type="radio" name="category" value="Concert"> Concert
				<input type="radio" name="category" value="Comedy"> Comedy
				<input type="radio" name="category" value="Random" checked> Random
			</div>
			<div>
				<label>Date:</label>
				<input type="radio" name="date" value="Today"> Today
				<input type="radio" name="date" value="Tomorrow"> Tomorrow
				<input type="date" name="date">
				<input type="radio" name="date" value="Random" checked> Random
			</div>
			<div>
				<label>Location:</label>
				<input type="radio" name="radius" value="5mi"> 5mi
				<input type="radio" name="radius" value="10mi"> 10mi
				<input type="radio" name="radius" value="15mi"> 15mi
				<input type="radio" name="radius" value="Random" checked> Random
				<input type="text" name="zip" placeholder="Enter Zip Code">
			</div>
			<button type="button" id="searchButton">Search</button>
		</form>
		<div id="results"></div>
	</main>
	<script>
		document.getElementById('searchButton').addEventListener('click', function () {
			const category = document.querySelector('input[name="category"]:checked').value;
			const dateInput = document.querySelector('input[name="date"]:not([type="radio"])');
			const date = dateInput && dateInput.value ? dateInput.value : document.querySelector('input[name="date"]:checked').value;
			const radius = document.querySelector('input[name="radius"]:checked').value;
			const zipCode = document.querySelector('input[name="zip"]').value;

			let apiUrl = `https://app.ticketmaster.com/discovery/v2/events.json?apikey=yUVLN9qdGfA0nVpOECDyuYT7ekGADMu3&size=10`;

			if (zipCode && radius !== 'Random') {
				apiUrl += `&postalCode=${zipCode}&radius=${radius}`;
			}
			if (category !== 'Random') {
				apiUrl += `&classificationName=${encodeURIComponent(category)}`;
			}
			if (date !== 'Random' && date !== '') {
				apiUrl += `&startDateTime=${date}T00:00:00Z`;
			}

			axios.get(apiUrl)
				.then(response => {
					const events = response.data._embedded.events;
					const resultsDiv = document.getElementById('results');
					resultsDiv.innerHTML = ''; // Clear previous results
					events.forEach(event => {
						const eventDiv = document.createElement('div');
						eventDiv.innerHTML = `<h4>${event.name}</h4><p>${event.dates.start.localDate}</p>`;
						resultsDiv.appendChild(eventDiv);
					});
				})
				.catch(error => {
					console.error('Failed to fetch events:', error);
					document.getElementById('results').innerText = 'Failed to fetch events';
				});
		});
		console.log(apiUrl);
	</script>
</body>

</html>